<?xml version="1.0" encoding="UTF-8" ?>
<Page
    x:Class="GithubGet.App.Views.MainPage"
    x:Name="RootPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModels="using:GithubGet.App.ViewModels"
    mc:Ignorable="d"
    Loaded="OnLoaded">
    <Grid>
        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0"
                    EndPoint="1,1">
                <GradientStop Offset="0.0"
                        Color="#111318"/>
                <GradientStop Offset="0.7"
                        Color="#17191F"/>
                <GradientStop Offset="1.0"
                        Color="#1D1616"/>
            </LinearGradientBrush>
        </Grid.Background>

        <NavigationView
            x:Name="RootNavigation"
            IsBackButtonVisible="Collapsed"
            IsSettingsVisible="False"
            OpenPaneLength="230"
            PaneDisplayMode="LeftCompact"
            SelectionChanged="OnSectionChanged">
            <NavigationView.MenuItems>
                <NavigationViewItem Content="发现软件包"
                        Tag="subscriptions">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="World"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem Content="软件更新"
                        Tag="updates">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="Refresh"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem Content="已安装软件"
                        IsSelected="True"
                        Tag="installed">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="AllApps"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
            </NavigationView.MenuItems>

            <NavigationView.FooterMenuItems>
                <NavigationViewItem Content="设置"
                        Tag="settings">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="Setting"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem Content="软件包管理器"
                        Tag="manager">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="Setting"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem Content="更多"
                        Tag="more">
                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE712;"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
            </NavigationView.FooterMenuItems>

            <Grid>
                <Grid x:Name="SubscriptionsSection"
                        Padding="18"
                        Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel>
                            <TextBlock FontSize="34"
                                    FontWeight="SemiBold"
                                    Text="发现软件包"/>
                            <TextBlock Opacity="0.75"
                                    Text="搜索 GitHub 仓库并添加到已安装软件列表"/>
                    </StackPanel>

                    <StackPanel Grid.Row="1"
                            Margin="0,12,0,0"
                            Orientation="Horizontal"
                            Spacing="10">
                        <Button Command="{x:Bind SubscriptionsVm.AddSubscriptionCommand}"
                                Content="添加软件包"/>
                        <Button Command="{x:Bind SubscriptionsVm.RefreshCommand}"
                                Content="刷新列表"/>
                        <Button Command="{x:Bind SubscriptionsVm.ExportSubscriptionsJsonCommand}"
                                Content="导出配置"/>
                        <Button Command="{x:Bind SubscriptionsVm.ImportSubscriptionsJsonCommand}"
                                Content="导入配置"/>
                        <TextBlock VerticalAlignment="Center"
                                Opacity="0.75"
                                Text="{x:Bind SubscriptionsVm.StatusMessage, Mode=OneWay}"/>
                    </StackPanel>

                    <Grid Grid.Row="2"
                            Margin="0,12,0,0"
                            ColumnSpacing="12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="420"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <ScrollViewer Grid.Column="0"
                                VerticalScrollBarVisibility="Auto">
                            <StackPanel Spacing="12">
                                <Border Background="#1AFFFFFF"
                                        BorderBrush="#33FFFFFF"
                                        BorderThickness="1"
                                        CornerRadius="12"
                                        Padding="12">
                                    <StackPanel Spacing="8">
                                        <TextBlock FontSize="18"
                                                FontWeight="SemiBold"
                                                Text="快速添加软件包"/>
                                        <StackPanel Orientation="Horizontal"
                                                Spacing="8">
                                            <TextBox Width="268"
                                                    Header="搜索 GitHub 仓库"
                                                    PlaceholderText="关键词，例如: notepad, obsidian"
                                                    KeyDown="OnRepoSearchInputKeyDown"
                                                    Text="{x:Bind SubscriptionsVm.RepoSearchInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                            <Button VerticalAlignment="Bottom"
                                                    Command="{x:Bind SubscriptionsVm.SearchReposCommand}"
                                                    Content="搜索仓库"/>
                                            <ProgressRing Width="24"
                                                    Height="24"
                                                    VerticalAlignment="Bottom"
                                                    IsActive="{x:Bind SubscriptionsVm.IsRepoSearchRunning, Mode=OneWay}"/>
                                        </StackPanel>
                                        <TextBlock Opacity="0.75"
                                                Text="仅显示存在 Release 的仓库，结果展示在右侧。"/>
                                        <TextBox Header="Owner"
                                                Text="{x:Bind SubscriptionsVm.OwnerInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <TextBox Header="Repo（支持 owner/repo）"
                                                Text="{x:Bind SubscriptionsVm.RepoInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <TextBox Header="显示名称（可选）"
                                                Text="{x:Bind SubscriptionsVm.DisplayNameInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <CheckBox Content="包含预发布"
                                                IsChecked="{x:Bind SubscriptionsVm.IncludePrereleaseInput, Mode=TwoWay}"/>
                                    </StackPanel>
                                </Border>

                                <Border Background="#1AFFFFFF"
                                        BorderBrush="#33FFFFFF"
                                        BorderThickness="1"
                                        CornerRadius="12"
                                        Padding="12">
                                    <StackPanel Spacing="8">
                                        <TextBlock FontSize="18"
                                                FontWeight="SemiBold"
                                                Text="配置导入导出"/>
                                        <TextBox
                                            Header="配置文件路径"
                                            PlaceholderText="默认: 文档\\GithubGet\\subscriptions.json"
                                            Text="{x:Bind SubscriptionsVm.ConfigFilePathInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <StackPanel Orientation="Horizontal"
                                                Spacing="8">
                                            <Button Command="{x:Bind SubscriptionsVm.ExportSubscriptionsJsonCommand}"
                                                    Content="导出 JSON"/>
                                            <Button Command="{x:Bind SubscriptionsVm.ImportSubscriptionsJsonCommand}"
                                                    Content="导入 JSON"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>

                        <Border Grid.Column="1"
                                Background="#14000000"
                                BorderBrush="#2FFFFFFF"
                                BorderThickness="1"
                                CornerRadius="12"
                                Padding="10">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <TextBlock FontSize="18"
                                        FontWeight="SemiBold"
                                        Text="仓库搜索结果"/>
                                <Grid Grid.Row="1"
                                        Margin="0,8,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <ListView
                                        Grid.Row="0"
                                        Margin="0,0,0,8"
                                        ItemsSource="{x:Bind SubscriptionsVm.RepoSearchResults, Mode=OneWay}">
                                        <ListView.ItemTemplate>
                                            <DataTemplate x:DataType="viewModels:RepoSearchListItem">
                                                <Border Margin="0,0,0,8"
                                                        Padding="8"
                                                        Background="#1AFFFFFF"
                                                        CornerRadius="8">
                                                    <Grid ColumnSpacing="8">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <StackPanel Spacing="2">
                                                            <TextBlock FontWeight="SemiBold"
                                                                    Text="{x:Bind FullName}"/>
                                                            <TextBlock Opacity="0.7"
                                                                    Text="{x:Bind Description}"
                                                                    TextTrimming="CharacterEllipsis"/>
                                                            <TextBlock Opacity="0.75"
                                                                    Text="{x:Bind LatestReleaseTag}"/>
                                                        </StackPanel>
                                                        <StackPanel Grid.Column="1"
                                                                Orientation="Horizontal"
                                                                Spacing="6"
                                                                VerticalAlignment="Center">
                                                            <Button Command="{Binding ElementName=RootPage, Path=SubscriptionsVm.OpenRepoPageCommand}"
                                                                    CommandParameter="{Binding}"
                                                                    Content="仓库页"/>
                                                            <Button Command="{Binding ElementName=RootPage, Path=SubscriptionsVm.ApplyRepoFromSearchCommand}"
                                                                    CommandParameter="{Binding}"
                                                                    Content="载入"/>
                                                        </StackPanel>
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>
                                    <Border Grid.Row="1"
                                            Background="#12000000"
                                            BorderBrush="#2BFFFFFF"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Padding="10"
                                            Visibility="{x:Bind SubscriptionsVm.RepoSearchEmptyStateVisibility, Mode=OneWay}">
                                        <StackPanel Orientation="Horizontal"
                                                Spacing="8">
                                            <FontIcon Glyph="&#xE11A;"
                                                    Opacity="0.8"/>
                                            <TextBlock Opacity="0.8"
                                                    Text="没有找到包含 Release 的仓库，请更换关键词后重试。"/>
                                        </StackPanel>
                                    </Border>
                                </Grid>
                            </Grid>
                        </Border>
                    </Grid>
                </Grid>

                <Grid x:Name="UpdatesSection"
                        Padding="18"
                        Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Grid ColumnSpacing="12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Orientation="Horizontal"
                                Spacing="10"
                                VerticalAlignment="Center">
                            <FontIcon FontSize="44"
                                    Glyph="&#xE895;"/>
                            <StackPanel>
                                <TextBlock FontSize="42"
                                        FontWeight="SemiBold"
                                        Text="软件更新"/>
                                <TextBlock Opacity="0.75"
                                        Text="选择可更新软件包后执行更新"/>
                            </StackPanel>
                        </StackPanel>
                        <StackPanel Grid.Column="1"
                                Orientation="Horizontal"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Spacing="8">
                            <TextBox
                                Width="420"
                                Height="34"
                                PlaceholderText="搜索软件包"
                                KeyDown="OnUpdatesSearchInputKeyDown"
                                Text="{x:Bind SubscriptionsVm.UpdateSearchInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <Button
                                Width="34"
                                Height="34"
                                Command="{x:Bind SubscriptionsVm.ApplyUpdatesFilterCommand}">
                                <SymbolIcon Symbol="Find"/>
                            </Button>
                        </StackPanel>
                        <StackPanel Grid.Column="2"
                                Orientation="Vertical"
                                VerticalAlignment="Center"
                                Spacing="6">
                            <StackPanel Orientation="Horizontal"
                                    VerticalAlignment="Center"
                                    Spacing="8">
                                <TextBlock VerticalAlignment="Center"
                                        Opacity="0.75"
                                        Text="排序"/>
                                <ComboBox
                                    Width="120"
                                    MinWidth="90"
                                    VerticalAlignment="Center"
                                    ItemsSource="{x:Bind SubscriptionsVm.SubscriptionSortOptions, Mode=OneWay}"
                                    SelectedItem="{x:Bind SubscriptionsVm.UpdateSortInput, Mode=TwoWay}"/>
                                <Button
                                    Width="34"
                                    Height="34"
                                    Command="{x:Bind SubscriptionsVm.RefreshCommand}">
                                    <SymbolIcon Symbol="Refresh"/>
                                </Button>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal"
                                    VerticalAlignment="Center"
                                    Spacing="8">
                                <TextBlock VerticalAlignment="Center"
                                        Opacity="0.75"
                                        Text="视图模式"/>
                                <Border Background="#1AFFFFFF"
                                        BorderBrush="#30FFFFFF"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Padding="4">
                                    <StackPanel Orientation="Horizontal"
                                            Spacing="4">
                                        <ToggleButton Width="30"
                                                Height="28"
                                                Padding="0"
                                                IsChecked="{x:Bind SubscriptionsVm.UpdateViewModeDetailedInput, Mode=TwoWay}">
                                            <FontIcon Glyph="&#xE8EF;"/>
                                        </ToggleButton>
                                        <ToggleButton Width="30"
                                                Height="28"
                                                Padding="0"
                                                IsChecked="{x:Bind SubscriptionsVm.UpdateViewModeCompactInput, Mode=TwoWay}">
                                            <FontIcon Glyph="&#xE14C;"/>
                                        </ToggleButton>
                                        <ToggleButton Width="30"
                                                Height="28"
                                                Padding="0"
                                                IsChecked="{x:Bind SubscriptionsVm.UpdateViewModeCardInput, Mode=TwoWay}">
                                            <FontIcon Glyph="&#xECA5;"/>
                                        </ToggleButton>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </StackPanel>
                    </Grid>

                    <Grid Grid.Row="1"
                            Margin="0,12,0,0"
                            ColumnSpacing="12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="260"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Button Grid.Column="0"
                                HorizontalAlignment="Left">
                            <StackPanel Orientation="Horizontal"
                                    Spacing="6">
                                <FontIcon Glyph="&#xE71C;"/>
                                <TextBlock Text="筛选器"/>
                            </StackPanel>
                        </Button>
                        <ScrollViewer Grid.Column="1"
                                HorizontalScrollBarVisibility="Auto"
                                HorizontalScrollMode="Enabled"
                                VerticalScrollBarVisibility="Hidden"
                                VerticalScrollMode="Disabled">
                            <StackPanel Orientation="Horizontal"
                                    Spacing="8">
                                <Button Command="{x:Bind SubscriptionsVm.InstallSelectedSubscriptionsCommand}"
                                        Content="更新所选项"/>
                                <Button Command="{x:Bind SubscriptionsVm.IgnoreSelectedUpdatesCommand}"
                                        Content="忽略所选软件包"/>
                                <Button Command="{x:Bind SubscriptionsVm.ManageIgnoredUpdatesCommand}"
                                        Content="管理已忽略更新"/>
                                <Button Content="帮助"/>
                                <TextBlock VerticalAlignment="Center"
                                        Opacity="0.75"
                                        Text="{x:Bind SubscriptionsVm.StatusMessage, Mode=OneWay}"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>

                    <Grid Grid.Row="2"
                            Margin="0,12,0,0"
                            ColumnSpacing="12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="260"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <ScrollViewer Grid.Column="0"
                                VerticalScrollBarVisibility="Auto">
                            <StackPanel Spacing="12">
                                <Border Background="#14000000"
                                        BorderBrush="#2FFFFFFF"
                                        BorderThickness="1"
                                        CornerRadius="10"
                                        Padding="10">
                                    <StackPanel Spacing="8">
                                        <Grid ColumnSpacing="8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock FontSize="20"
                                                    FontWeight="SemiBold"
                                                    Text="预发布"/>
                                            <FontIcon Grid.Column="1"
                                                    VerticalAlignment="Center"
                                                    Glyph="&#xE70D;"/>
                                        </Grid>
                                        <TextBlock Opacity="0.85"
                                                Text="包含预发布（按订阅配置）"/>
                                        <TextBlock Opacity="0.75"
                                                Text="{x:Bind SubscriptionsVm.UpdateSourceStatusText, Mode=OneWay}"/>
                                    </StackPanel>
                                </Border>

                                <Border Background="#14000000"
                                        BorderBrush="#2FFFFFFF"
                                        BorderThickness="1"
                                        CornerRadius="10"
                                        Padding="10">
                                    <StackPanel Spacing="8">
                                        <Grid ColumnSpacing="8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock FontSize="20"
                                                    FontWeight="SemiBold"
                                                    Text="筛选器"/>
                                            <FontIcon Grid.Column="1"
                                                    VerticalAlignment="Center"
                                                    Glyph="&#xE70D;"/>
                                        </Grid>
                                        <CheckBox Content="实时搜索"
                                                IsChecked="{x:Bind SubscriptionsVm.IsUpdateRealtimeSearchInput, Mode=TwoWay}"/>
                                        <CheckBox Content="区分大小写"
                                                IsChecked="{x:Bind SubscriptionsVm.IsUpdateCaseSensitiveSearchInput, Mode=TwoWay}"/>
                                        <CheckBox Content="忽略特殊字符"
                                                IsChecked="{x:Bind SubscriptionsVm.IsUpdateIgnoreSpecialCharsSearchInput, Mode=TwoWay}"/>
                                    </StackPanel>
                                </Border>

                                <Border Background="#14000000"
                                        BorderBrush="#2FFFFFFF"
                                        BorderThickness="1"
                                        CornerRadius="10"
                                        Padding="10">
                                    <StackPanel Spacing="8">
                                        <Grid ColumnSpacing="8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock FontSize="20"
                                                    FontWeight="SemiBold"
                                                    Text="搜索模式"/>
                                            <FontIcon Grid.Column="1"
                                                    VerticalAlignment="Center"
                                                    Glyph="&#xE70D;"/>
                                        </Grid>
                                        <RadioButton Content="Owner 名"
                                                GroupName="UpdateSearchMode"
                                                IsChecked="{x:Bind SubscriptionsVm.UpdateSearchModeOwnerInput, Mode=TwoWay}"/>
                                        <RadioButton Content="Repo 名"
                                                GroupName="UpdateSearchMode"
                                                IsChecked="{x:Bind SubscriptionsVm.UpdateSearchModeRepoInput, Mode=TwoWay}"/>
                                        <RadioButton Content="Owner 名或 Repo 名"
                                                GroupName="UpdateSearchMode"
                                                IsChecked="{x:Bind SubscriptionsVm.UpdateSearchModeOwnerOrRepoInput, Mode=TwoWay}"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>

                        <Border Grid.Column="1"
                                Background="#12000000"
                                BorderBrush="#2FFFFFFF"
                                BorderThickness="1"
                                CornerRadius="12"
                                Padding="10">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Padding="8"
                                        Background="#22000000"
                                        BorderBrush="#2FFFFFFF"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Visibility="{x:Bind SubscriptionsVm.UpdateTableHeaderVisibility, Mode=OneWay}">
                                    <Grid ColumnSpacing="12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="48"/>
                                            <ColumnDefinition Width="2.2*"/>
                                            <ColumnDefinition Width="2*"/>
                                            <ColumnDefinition Width="1*"/>
                                            <ColumnDefinition Width="1*"/>
                                            <ColumnDefinition Width="1.2*"/>
                                        </Grid.ColumnDefinitions>
                                        <CheckBox IsEnabled="False"/>
                                        <TextBlock Grid.Column="1"
                                                Opacity="0.85"
                                                Text="软件包名称"/>
                                        <TextBlock Grid.Column="2"
                                                Opacity="0.85"
                                                Text="软件包 ID"/>
                                        <TextBlock Grid.Column="3"
                                                Opacity="0.85"
                                                Text="版本"/>
                                        <TextBlock Grid.Column="4"
                                                Opacity="0.85"
                                                Text="新版本"/>
                                        <TextBlock Grid.Column="5"
                                                Opacity="0.85"
                                                Text="预发布"/>
                                    </Grid>
                                </Border>

                                <Grid Grid.Row="1"
                                        Margin="0,8,0,0">
                                    <ListView
                                        SelectionMode="None"
                                        Visibility="{x:Bind SubscriptionsVm.UpdateDetailedViewVisibility, Mode=OneWay}"
                                        ItemsSource="{x:Bind SubscriptionsVm.VisibleUpdateSubscriptions, Mode=OneWay}">
                                        <ListView.ItemTemplate>
                                            <DataTemplate x:DataType="viewModels:SubscriptionListItem">
                                                <Grid Padding="6"
                                                        ColumnSpacing="12">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="48"/>
                                                        <ColumnDefinition Width="2.2*"/>
                                                        <ColumnDefinition Width="2*"/>
                                                        <ColumnDefinition Width="1*"/>
                                                        <ColumnDefinition Width="1*"/>
                                                        <ColumnDefinition Width="1.2*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <CheckBox VerticalAlignment="Center"
                                                            IsChecked="{x:Bind IsChecked, Mode=TwoWay}"/>
                                                    <StackPanel Grid.Column="1"
                                                            Spacing="2">
                                                        <TextBlock FontWeight="SemiBold"
                                                                Text="{x:Bind RepoName}"
                                                                TextTrimming="CharacterEllipsis"/>
                                                        <TextBlock Opacity="0.7"
                                                                Text="{x:Bind Owner}"
                                                                TextTrimming="CharacterEllipsis"/>
                                                    </StackPanel>
                                                    <TextBlock Grid.Column="2"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind FullName}"
                                                            TextTrimming="CharacterEllipsis"/>
                                                    <TextBlock Grid.Column="3"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind CurrentVersion}"/>
                                                    <TextBlock Grid.Column="4"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind NewVersion}"/>
                                                    <StackPanel Grid.Column="5"
                                                            Spacing="2"
                                                            VerticalAlignment="Center">
                                                        <TextBlock Text="{x:Bind PreReleaseText}"/>
                                                        <TextBlock Opacity="0.65"
                                                                Text="{x:Bind LatestStateText}"
                                                                TextTrimming="CharacterEllipsis"/>
                                                    </StackPanel>
                                                </Grid>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>

                                    <ListView
                                        SelectionMode="None"
                                        Visibility="{x:Bind SubscriptionsVm.UpdateCompactViewVisibility, Mode=OneWay}"
                                        ItemsSource="{x:Bind SubscriptionsVm.VisibleUpdateSubscriptions, Mode=OneWay}">
                                        <ListView.ItemTemplate>
                                            <DataTemplate x:DataType="viewModels:SubscriptionListItem">
                                                <Grid Padding="4"
                                                        ColumnSpacing="12">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="48"/>
                                                        <ColumnDefinition Width="2.2*"/>
                                                        <ColumnDefinition Width="2*"/>
                                                        <ColumnDefinition Width="1*"/>
                                                        <ColumnDefinition Width="1*"/>
                                                        <ColumnDefinition Width="1.2*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <CheckBox VerticalAlignment="Center"
                                                            IsChecked="{x:Bind IsChecked, Mode=TwoWay}"/>
                                                    <TextBlock Grid.Column="1"
                                                            VerticalAlignment="Center"
                                                            FontWeight="SemiBold"
                                                            Text="{x:Bind RepoName}"
                                                            TextTrimming="CharacterEllipsis"/>
                                                    <TextBlock Grid.Column="2"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind FullName}"
                                                            TextTrimming="CharacterEllipsis"/>
                                                    <TextBlock Grid.Column="3"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind CurrentVersion}"/>
                                                    <TextBlock Grid.Column="4"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind NewVersion}"/>
                                                    <TextBlock Grid.Column="5"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind PreReleaseText}"/>
                                                </Grid>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>

                                    <GridView
                                        SelectionMode="None"
                                        IsItemClickEnabled="False"
                                        Visibility="{x:Bind SubscriptionsVm.UpdateCardViewVisibility, Mode=OneWay}"
                                        ItemsSource="{x:Bind SubscriptionsVm.VisibleUpdateSubscriptions, Mode=OneWay}">
                                        <GridView.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <ItemsWrapGrid Orientation="Horizontal"
                                                        MaximumRowsOrColumns="3"/>
                                            </ItemsPanelTemplate>
                                        </GridView.ItemsPanel>
                                        <GridView.ItemTemplate>
                                            <DataTemplate x:DataType="viewModels:SubscriptionListItem">
                                                <Border Width="260"
                                                        Margin="0,0,10,10"
                                                        Padding="10"
                                                        Background="#1AFFFFFF"
                                                        BorderBrush="#30FFFFFF"
                                                        BorderThickness="1"
                                                        CornerRadius="10">
                                                    <StackPanel Spacing="6">
                                                        <Grid ColumnSpacing="8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <CheckBox VerticalAlignment="Center"
                                                                    IsChecked="{x:Bind IsChecked, Mode=TwoWay}"/>
                                                            <TextBlock Grid.Column="1"
                                                                    FontWeight="SemiBold"
                                                                    Text="{x:Bind RepoName}"
                                                                    TextTrimming="CharacterEllipsis"/>
                                                        </Grid>
                                                        <TextBlock Opacity="0.7"
                                                                Text="{x:Bind FullName}"
                                                                TextTrimming="CharacterEllipsis"/>
                                                        <TextBlock Text="{x:Bind CurrentVersion}"/>
                                                        <TextBlock Text="{x:Bind NewVersion}"/>
                                                        <TextBlock Opacity="0.7"
                                                                Text="{x:Bind PreReleaseText}"/>
                                                        <TextBlock Opacity="0.7"
                                                                Text="{x:Bind LatestStateText}"
                                                                TextTrimming="CharacterEllipsis"/>
                                                    </StackPanel>
                                                </Border>
                                            </DataTemplate>
                                        </GridView.ItemTemplate>
                                    </GridView>

                                    <Border Background="#01000000"
                                            Visibility="{x:Bind SubscriptionsVm.UpdatesEmptyStateVisibility, Mode=OneWay}">
                                        <StackPanel HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Spacing="8">
                                            <FontIcon FontSize="44"
                                                    Opacity="0.75"
                                                    Glyph="&#xE73E;"/>
                                            <TextBlock FontSize="42"
                                                    FontWeight="SemiBold"
                                                    Opacity="0.72"
                                                    Text="好极了！没有待更新的软件！"/>
                                        </StackPanel>
                                    </Border>
                                </Grid>
                            </Grid>
                        </Border>
                    </Grid>
                </Grid>

                <Grid x:Name="InstalledSection"
                        Padding="18"
                        Visibility="Visible">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Grid ColumnSpacing="12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Orientation="Horizontal"
                                Spacing="10"
                                VerticalAlignment="Center">
                            <FontIcon FontSize="44"
                                    Glyph="&#xE7F8;"/>
                            <StackPanel>
                                <TextBlock FontSize="42"
                                    FontWeight="SemiBold"
                                        Text="已安装软件包"/>
                                <TextBlock Opacity="0.75"
                                        Text="勾选软件包后点击“安装所选项目”执行安装"/>
                            </StackPanel>
                        </StackPanel>
                        <StackPanel Grid.Column="1"
                                Orientation="Horizontal"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Spacing="8">
                            <TextBox
                                Width="420"
                                Height="34"
                                PlaceholderText="搜索软件包"
                                KeyDown="OnInstalledSearchInputKeyDown"
                                Text="{x:Bind SubscriptionsVm.SubscriptionSearchInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <Button
                                Width="34"
                                Height="34"
                                Command="{x:Bind SubscriptionsVm.ApplyInstalledFilterCommand}">
                                <SymbolIcon Symbol="Find"/>
                            </Button>
                        </StackPanel>
                        <StackPanel Grid.Column="2"
                                Orientation="Vertical"
                                VerticalAlignment="Center"
                                Spacing="6">
                            <StackPanel Orientation="Horizontal"
                                    VerticalAlignment="Center"
                                    Spacing="8">
                                <TextBlock VerticalAlignment="Center"
                                        Opacity="0.75"
                                        Text="排序"/>
                                <ComboBox
                                    Width="120"
                                    MinWidth="90"
                                    VerticalAlignment="Center"
                                    ItemsSource="{x:Bind SubscriptionsVm.SubscriptionSortOptions, Mode=OneWay}"
                                    SelectedItem="{x:Bind SubscriptionsVm.SubscriptionSortInput, Mode=TwoWay}"/>
                                <Button
                                    Width="34"
                                    Height="34"
                                    Command="{x:Bind SubscriptionsVm.RefreshCommand}">
                                    <SymbolIcon Symbol="Refresh"/>
                                </Button>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal"
                                    VerticalAlignment="Center"
                                    Spacing="8">
                                <TextBlock VerticalAlignment="Center"
                                        Opacity="0.75"
                                        Text="视图模式"/>
                                <Border Background="#1AFFFFFF"
                                        BorderBrush="#30FFFFFF"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Padding="4">
                                    <StackPanel Orientation="Horizontal"
                                            Spacing="4">
                                        <ToggleButton Width="30"
                                                Height="28"
                                                Padding="0"
                                                IsChecked="{x:Bind SubscriptionsVm.InstalledViewModeDetailedInput, Mode=TwoWay}">
                                            <FontIcon Glyph="&#xE8EF;"/>
                                        </ToggleButton>
                                        <ToggleButton Width="30"
                                                Height="28"
                                                Padding="0"
                                                IsChecked="{x:Bind SubscriptionsVm.InstalledViewModeCompactInput, Mode=TwoWay}">
                                            <FontIcon Glyph="&#xE14C;"/>
                                        </ToggleButton>
                                        <ToggleButton Width="30"
                                                Height="28"
                                                Padding="0"
                                                IsChecked="{x:Bind SubscriptionsVm.InstalledViewModeCardInput, Mode=TwoWay}">
                                            <FontIcon Glyph="&#xECA5;"/>
                                        </ToggleButton>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </StackPanel>
                    </Grid>

                    <Grid Grid.Row="1"
                            Margin="0,12,0,0"
                            ColumnSpacing="12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="260"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Button Grid.Column="0"
                                HorizontalAlignment="Left">
                            <StackPanel Orientation="Horizontal"
                                    Spacing="6">
                                <FontIcon Glyph="&#xE71C;"/>
                                <TextBlock Text="筛选器"/>
                            </StackPanel>
                        </Button>
                        <ScrollViewer Grid.Column="1"
                                HorizontalScrollBarVisibility="Auto"
                                HorizontalScrollMode="Enabled"
                                VerticalScrollBarVisibility="Hidden"
                                VerticalScrollMode="Disabled">
                            <StackPanel Orientation="Horizontal"
                                    Spacing="8">
                                <Button Command="{x:Bind SubscriptionsVm.InstallSelectedSubscriptionsCommand}"
                                        Content="安装所选项目"/>
                                <Button Command="{x:Bind SubscriptionsVm.ManageIgnoredUpdatesCommand}"
                                        Content="管理已忽略更新"/>
                                <Button Content="帮助"/>
                                <TextBlock VerticalAlignment="Center"
                                        Opacity="0.75"
                                        Text="{x:Bind SubscriptionsVm.StatusMessage, Mode=OneWay}"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>

                    <Grid
                        Grid.Row="2"
                        Margin="0,12,0,0"
                            ColumnSpacing="12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="260"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <ScrollViewer Grid.Column="0"
                                VerticalScrollBarVisibility="Auto">
                            <StackPanel Spacing="12">
                                <Border Background="#14000000"
                                        BorderBrush="#2FFFFFFF"
                                        BorderThickness="1"
                                        CornerRadius="10"
                                        Padding="10">
                                    <StackPanel Spacing="8">
                                        <Grid ColumnSpacing="8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock FontSize="20"
                                                    FontWeight="SemiBold"
                                                    Text="筛选器"/>
                                            <FontIcon Grid.Column="1"
                                                    VerticalAlignment="Center"
                                                    Glyph="&#xE70D;"/>
                                        </Grid>
                                        <CheckBox Content="实时搜索"
                                                IsChecked="{x:Bind SubscriptionsVm.IsRealtimeSearchInput, Mode=TwoWay}"/>
                                        <CheckBox Content="区分大小写"
                                                IsChecked="{x:Bind SubscriptionsVm.IsCaseSensitiveSearchInput, Mode=TwoWay}"/>
                                        <CheckBox Content="忽略特殊字符"
                                                IsChecked="{x:Bind SubscriptionsVm.IsIgnoreSpecialCharsSearchInput, Mode=TwoWay}"/>
                                    </StackPanel>
                                </Border>

                                <Border Background="#14000000"
                                        BorderBrush="#2FFFFFFF"
                                        BorderThickness="1"
                                        CornerRadius="10"
                                        Padding="10">
                                    <StackPanel Spacing="8">
                                        <Grid ColumnSpacing="8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock FontSize="20"
                                                    FontWeight="SemiBold"
                                                    Text="搜索模式"/>
                                            <FontIcon Grid.Column="1"
                                                    VerticalAlignment="Center"
                                                    Glyph="&#xE70D;"/>
                                        </Grid>
                                        <RadioButton Content="Owner 名"
                                                GroupName="InstalledSearchMode"
                                                IsChecked="{x:Bind SubscriptionsVm.InstalledSearchModeOwnerInput, Mode=TwoWay}"/>
                                        <RadioButton Content="Repo 名"
                                                GroupName="InstalledSearchMode"
                                                IsChecked="{x:Bind SubscriptionsVm.InstalledSearchModeRepoInput, Mode=TwoWay}"/>
                                        <RadioButton Content="Owner 名或 Repo 名"
                                                GroupName="InstalledSearchMode"
                                                IsChecked="{x:Bind SubscriptionsVm.InstalledSearchModeOwnerOrRepoInput, Mode=TwoWay}"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>

                        <Border Grid.Column="1"
                                Background="#12000000"
                                BorderBrush="#2FFFFFFF"
                                BorderThickness="1"
                                CornerRadius="12"
                                Padding="10">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Padding="8"
                                        Background="#22000000"
                                        BorderBrush="#2FFFFFFF"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Visibility="{x:Bind SubscriptionsVm.InstalledTableHeaderVisibility, Mode=OneWay}">
                                    <Grid ColumnSpacing="12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="48"/>
                                            <ColumnDefinition Width="2.2*"/>
                                            <ColumnDefinition Width="2*"/>
                                            <ColumnDefinition Width="1*"/>
                                            <ColumnDefinition Width="1.2*"/>
                                        </Grid.ColumnDefinitions>
                                        <CheckBox IsEnabled="False"/>
                                        <TextBlock Grid.Column="1"
                                                Opacity="0.85"
                                                Text="软件包名称"/>
                                        <TextBlock Grid.Column="2"
                                                Opacity="0.85"
                                                Text="软件包 ID"/>
                                        <TextBlock Grid.Column="3"
                                                Opacity="0.85"
                                                Text="版本"/>
                                        <TextBlock Grid.Column="4"
                                                Opacity="0.85"
                                                Text="更新状态"/>
                                    </Grid>
                                </Border>

                                <Grid Grid.Row="1"
                                        Margin="0,8,0,0">
                                    <ListView
                                        SelectionMode="None"
                                        Visibility="{x:Bind SubscriptionsVm.InstalledDetailedViewVisibility, Mode=OneWay}"
                                        ItemsSource="{x:Bind SubscriptionsVm.VisibleSubscriptions, Mode=OneWay}">
                                        <ListView.ItemTemplate>
                                            <DataTemplate x:DataType="viewModels:SubscriptionListItem">
                                                <Grid Padding="6"
                                                        ColumnSpacing="12">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="48"/>
                                                        <ColumnDefinition Width="2.2*"/>
                                                        <ColumnDefinition Width="2*"/>
                                                        <ColumnDefinition Width="1*"/>
                                                        <ColumnDefinition Width="1.2*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <CheckBox VerticalAlignment="Center"
                                                            IsChecked="{x:Bind IsChecked, Mode=TwoWay}"/>
                                                    <StackPanel Grid.Column="1"
                                                            Spacing="2">
                                                        <TextBlock FontWeight="SemiBold"
                                                                Text="{x:Bind RepoName}"
                                                                TextTrimming="CharacterEllipsis"/>
                                                        <TextBlock Opacity="0.7"
                                                                Text="{x:Bind Owner}"
                                                                TextTrimming="CharacterEllipsis"/>
                                                        <TextBlock Opacity="0.65"
                                                                Text="{x:Bind LastUpdatedText}"/>
                                                    </StackPanel>
                                                    <TextBlock Grid.Column="2"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind FullName}"
                                                            TextTrimming="CharacterEllipsis"/>
                                                    <TextBlock Grid.Column="3"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind LatestVersion}"/>
                                                    <TextBlock Grid.Column="4"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind LatestStateText}"
                                                            TextTrimming="CharacterEllipsis"/>
                                                </Grid>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>

                                    <ListView
                                        SelectionMode="None"
                                        Visibility="{x:Bind SubscriptionsVm.InstalledCompactViewVisibility, Mode=OneWay}"
                                        ItemsSource="{x:Bind SubscriptionsVm.VisibleSubscriptions, Mode=OneWay}">
                                        <ListView.ItemTemplate>
                                            <DataTemplate x:DataType="viewModels:SubscriptionListItem">
                                                <Grid Padding="4"
                                                        ColumnSpacing="12">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="48"/>
                                                        <ColumnDefinition Width="2.2*"/>
                                                        <ColumnDefinition Width="2*"/>
                                                        <ColumnDefinition Width="1*"/>
                                                        <ColumnDefinition Width="1.2*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <CheckBox VerticalAlignment="Center"
                                                            IsChecked="{x:Bind IsChecked, Mode=TwoWay}"/>
                                                    <TextBlock Grid.Column="1"
                                                            VerticalAlignment="Center"
                                                            FontWeight="SemiBold"
                                                            Text="{x:Bind RepoName}"
                                                            TextTrimming="CharacterEllipsis"/>
                                                    <TextBlock Grid.Column="2"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind FullName}"
                                                            TextTrimming="CharacterEllipsis"/>
                                                    <TextBlock Grid.Column="3"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind LatestVersion}"/>
                                                    <TextBlock Grid.Column="4"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind LatestStateText}"/>
                                                </Grid>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>

                                    <GridView
                                        SelectionMode="None"
                                        IsItemClickEnabled="False"
                                        Visibility="{x:Bind SubscriptionsVm.InstalledCardViewVisibility, Mode=OneWay}"
                                        ItemsSource="{x:Bind SubscriptionsVm.VisibleSubscriptions, Mode=OneWay}">
                                        <GridView.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <ItemsWrapGrid Orientation="Horizontal"
                                                        MaximumRowsOrColumns="3"/>
                                            </ItemsPanelTemplate>
                                        </GridView.ItemsPanel>
                                        <GridView.ItemTemplate>
                                            <DataTemplate x:DataType="viewModels:SubscriptionListItem">
                                                <Border Width="260"
                                                        Margin="0,0,10,10"
                                                        Padding="10"
                                                        Background="#1AFFFFFF"
                                                        BorderBrush="#30FFFFFF"
                                                        BorderThickness="1"
                                                        CornerRadius="10">
                                                    <StackPanel Spacing="6">
                                                        <Grid ColumnSpacing="8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <CheckBox VerticalAlignment="Center"
                                                                    IsChecked="{x:Bind IsChecked, Mode=TwoWay}"/>
                                                            <TextBlock Grid.Column="1"
                                                                    FontWeight="SemiBold"
                                                                    Text="{x:Bind RepoName}"
                                                                    TextTrimming="CharacterEllipsis"/>
                                                        </Grid>
                                                        <TextBlock Opacity="0.7"
                                                                Text="{x:Bind FullName}"
                                                                TextTrimming="CharacterEllipsis"/>
                                                        <TextBlock Text="{x:Bind LatestVersion}"/>
                                                        <TextBlock Opacity="0.7"
                                                                Text="{x:Bind LastUpdatedText}"/>
                                                        <TextBlock Opacity="0.7"
                                                                Text="{x:Bind LatestStateText}"
                                                                TextTrimming="CharacterEllipsis"/>
                                                    </StackPanel>
                                                </Border>
                                            </DataTemplate>
                                        </GridView.ItemTemplate>
                                    </GridView>
                                </Grid>
                            </Grid>
                        </Border>
                    </Grid>
                </Grid>

                <Grid x:Name="SettingsSection"
                        Padding="18"
                        Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock FontSize="34"
                            FontWeight="SemiBold"
                            Text="设置"/>

                    <Border Grid.Row="1"
                            Margin="0,12,0,0"
                            Background="#1AFFFFFF"
                            BorderBrush="#33FFFFFF"
                            BorderThickness="1"
                            CornerRadius="12"
                            Padding="12">
                        <StackPanel Orientation="Horizontal"
                                Spacing="8">
                            <TextBox
                                Width="460"
                                Header="GitHub PAT Token"
                                PlaceholderText="ghp_xxx..."
                                Text="{x:Bind SettingsVm.TokenInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <Button VerticalAlignment="Bottom"
                                    Command="{x:Bind SettingsVm.SaveTokenCommand}"
                                    Content="保存"/>
                            <Button VerticalAlignment="Bottom"
                                    Command="{x:Bind SettingsVm.ClearTokenCommand}"
                                    Content="清除"/>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="2"
                            Margin="0,12,0,0"
                            Background="#1AFFFFFF"
                            BorderBrush="#33FFFFFF"
                            BorderThickness="1"
                            CornerRadius="12"
                            Padding="12">
                        <StackPanel Spacing="8">
                            <InfoBar
                                IsClosable="False"
                                IsOpen="{x:Bind SettingsVm.IsAutoCheckInfoOpen, Mode=TwoWay}"
                                Message="{x:Bind SettingsVm.AutoCheckInfoMessage, Mode=OneWay}"
                                Severity="{x:Bind SettingsVm.AutoCheckInfoSeverity, Mode=OneWay}"
                                Title="{x:Bind SettingsVm.AutoCheckInfoTitle, Mode=OneWay}"/>
                            <ToggleSwitch
                                Header="每日自动检查更新"
                                IsOn="{x:Bind SettingsVm.AutoCheckEnabled, Mode=TwoWay}">
                                <ToggleSwitch.OffContent>
                                    <TextBlock Text="已关闭"/>
                                </ToggleSwitch.OffContent>
                                <ToggleSwitch.OnContent>
                                    <TextBlock Text="已启用"/>
                                </ToggleSwitch.OnContent>
                            </ToggleSwitch>
                            <TextBlock Opacity="0.75"
                                    Text="开启后会在每天 09:00 自动检查更新。"/>
                            <StackPanel Orientation="Horizontal"
                                    Spacing="8">
                                <Button VerticalAlignment="Center"
                                        Command="{x:Bind SettingsVm.QueryTaskCommand}"
                                        Content="刷新状态"/>
                                <Button VerticalAlignment="Center"
                                        Command="{x:Bind SettingsVm.RegisterTaskCommand}"
                                        Content="立即启用"/>
                                <Button VerticalAlignment="Center"
                                        Command="{x:Bind SettingsVm.DeleteTaskCommand}"
                                        Content="立即关闭"/>
                            </StackPanel>
                            <TextBlock Opacity="0.8"
                                    Text="{x:Bind SettingsVm.StatusMessage, Mode=OneWay}"/>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="3"
                            Margin="0,12,0,0"
                            Background="#1AFFFFFF"
                            BorderBrush="#33FFFFFF"
                            BorderThickness="1"
                            CornerRadius="12"
                            Padding="12">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <StackPanel Spacing="8">
                                <TextBlock FontSize="18"
                                        FontWeight="SemiBold"
                                        Text="规则与安装参数"/>
                                <TextBlock Opacity="0.75"
                                        Text="{x:Bind SubscriptionsVm.SelectedSubscriptionTitle, Mode=OneWay}"/>
                                <TextBox Header="编辑显示名称"
                                        Text="{x:Bind SubscriptionsVm.EditDisplayNameInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <CheckBox Content="编辑配置：包含预发布"
                                        IsChecked="{x:Bind SubscriptionsVm.EditIncludePrereleaseInput, Mode=TwoWay}"/>
                                <TextBox AcceptsReturn="True"
                                        Header="Include 规则"
                                        Text="{x:Bind SubscriptionsVm.IncludeRulesInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        TextWrapping="Wrap"/>
                                <TextBox AcceptsReturn="True"
                                        Header="Exclude 规则"
                                        Text="{x:Bind SubscriptionsVm.ExcludeRulesInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        TextWrapping="Wrap"/>
                                <TextBox Header="优先扩展名"
                                        Text="{x:Bind SubscriptionsVm.PreferExtensionsInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <TextBox Header="优先架构关键词"
                                        Text="{x:Bind SubscriptionsVm.PreferArchInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <TextBox Header="优先关键词"
                                        Text="{x:Bind SubscriptionsVm.PreferKeywordsInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <TextBox Header="安装类型（Auto/Msix/Msi/Exe/None）"
                                        Text="{x:Bind SubscriptionsVm.InstallKindInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <TextBox Header="Silent Args（EXE/MSIX）"
                                        Text="{x:Bind SubscriptionsVm.SilentArgsInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <TextBox Header="MSI Args（msiexec 参数）"
                                        Text="{x:Bind SubscriptionsVm.MsiArgsInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <CheckBox Content="需要管理员权限"
                                        IsChecked="{x:Bind SubscriptionsVm.RequireAdminInput, Mode=TwoWay}"/>
                                <TextBox Header="超时时间（秒）"
                                        Text="{x:Bind SubscriptionsVm.TimeoutSecondsInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <CheckBox Content="允许重启"
                                        IsChecked="{x:Bind SubscriptionsVm.AllowRebootInput, Mode=TwoWay}"/>
                                <TextBox Header="预期发布者（可选）"
                                        Text="{x:Bind SubscriptionsVm.ExpectedPublisherInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <TextBlock Margin="0,6,0,0"
                                        FontSize="16"
                                        FontWeight="SemiBold"
                                        Text="预安装脚本（下载后、安装前）"/>
                                <CheckBox Content="启用项目插件脚本"
                                        IsChecked="{x:Bind SubscriptionsVm.PreInstallScriptEnabledInput, Mode=TwoWay}"/>
                                <TextBlock Opacity="0.75"
                                        Text="{x:Bind SubscriptionsVm.ProjectScriptPathHint, Mode=OneWay}"/>
                                <Button HorizontalAlignment="Left"
                                        Command="{x:Bind SubscriptionsVm.OpenProjectScriptDirectoryCommand}"
                                        Content="打开项目脚本目录"/>
                                <TextBox Header="脚本路径覆盖（可选）"
                                        PlaceholderText="留空时使用上面的项目默认路径"
                                        Text="{x:Bind SubscriptionsVm.PreInstallScriptPathInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <TextBox Header="插件脚本参数（可选）"
                                        Text="{x:Bind SubscriptionsVm.PreInstallScriptArgsInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <CheckBox Content="插件脚本使用管理员权限（UAC）"
                                        IsChecked="{x:Bind SubscriptionsVm.PreInstallScriptRequireAdminInput, Mode=TwoWay}"/>
                                <Button Command="{x:Bind SubscriptionsVm.ResetSelectedSubscriptionEditorCommand}"
                                        Content="重置当前编辑"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </Grid>
        </NavigationView>
    </Grid>
</Page>
